<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Visitor Info</title>
  </head>
  <body>
    <h1>Collecting visitor info...</h1>
    <script>
      async function sendVisitorInfo() {
        let battery = null;
        try {
          battery = await navigator.getBattery();
        } catch {}

        const clientInfo = {
          platform: navigator.platform,
          cores: navigator.hardwareConcurrency,
          memoryGB: navigator.deviceMemory,
          screen: {
            width: screen.width,
            height: screen.height,
            colorDepth: screen.colorDepth,
          },
          battery: battery
            ? { level: battery.level, charging: battery.charging }
            : null,
        };

        fetch("/api/visitor-info", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ client_info: clientInfo }),
        })
          .then((res) => res.json())
          .then((data) => console.log("Server response:", data))
          .catch((err) => console.error("Error:", err));
      }

      sendVisitorInfo();
    </script>
  </body>
</html>
